---
import { getCollection } from "astro:content";
import ContactCTA from "../../components/ContactCTA.astro";
import Hero from "../../components/Hero.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

const blogList = (await getCollection("blog"))
  .filter((item) => item.data.publishDate.getTime() < new Date().getTime())
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
---

<BaseLayout
  title="My Blog | Leo Wang"
  description="Learn about Leo Wang's most recent projects."
>
  <div class="stack gap-20">
    <main class="wrapper stack gap-8">
      <Hero
        title="My Blog"
        tagline="See my most recent projects below to get an idea of my past experience."
        align="start"
      />
      <div class="blog-list">
        {
          blogList.map(({ slug, data: { title, tags, img, img_alt } }) => (
            <li>
              <a class="card" href={`/blog/${slug}`}>
                <span class="title">{title}</span>
                {img && (
                  <img
                    src={img}
                    alt={img_alt || ""}
                    loading="lazy"
                    decoding="async"
                  />
                )}
                <span class="tags">
                  {tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </span>
              </a>
            </li>
          ))
        }
      </div>
    </main>
    <ContactCTA />
  </div>
</BaseLayout>

<style>
  .blog-list {
    margin: 0 auto;
    max-width: 50rem;
  }
  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
</style>
